{"version":3,"sources":["webpack:///./src/api/node.js","webpack:///./src/views/command/modal/LogInfo.vue?37d3","webpack:///src/views/command/modal/LogInfo.vue","webpack:///./src/views/command/modal/LogInfo.vue?686c","webpack:///./src/views/command/modal/LogInfo.vue","webpack:///./src/views/command/CmdExec.vue?5449","webpack:///src/views/command/CmdExec.vue","webpack:///./src/views/command/CmdExec.vue?1ddb","webpack:///./src/views/command/CmdExec.vue","webpack:///./src/api/command.js"],"names":["nodeApi","nodeList","nodeRemove","parameter","request","url","method","data","render","_vm","this","_h","$createElement","_c","_self","attrs","visible","on","cancel","_v","_s","cmdName","record","id","user","result_at","staticStyle","_f","create_at","_e","node","dir","context","minRows","maxRows","result","staticRenderFns","name","components","moment","props","type","required","default","filters","formatDate","time","unix","format","mounted","console","methods","$emit","component","form","$router","go","spinning","ref","formRule","span","ctx_readonly","model","value","callback","$$v","$set","expression","slot","directives","rawName","_l","v","kk","key","args","i","offset","onSubmit","logInfoVisible","logInfoCmd","logInfoRecord","logInfoCancel","LogInfo","timeout","validator","message","trigger","hasArgs","nodes","$route","params","Object","keys","length","back","getNodeList","pageNo","pageSize","then","valid","cmdExec","catch","finally","checkTimout","rule","showLogInfo","cmdApi","cmdList","cmdCreate","cmdDelete","cmdUpdate","cmdLog"],"mappings":"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","file":"js/chunk-5c871f98.f1c211a4.js","sourcesContent":["import request from '@/utils/request'\n\nconst nodeApi = {\n  nodeList: 'node/list',\n  nodeRemove: 'node/remove'\n}\n\nexport function nodeList (parameter) {\n  return request({\n    url: nodeApi.nodeList,\n    method: 'post',\n    data: parameter\n  })\n}\n\nexport function nodeRemove (parameter) {\n  return request({\n    url: nodeApi.nodeRemove,\n    method: 'post',\n    data: parameter\n  })\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-modal',{attrs:{\"title\":\"执行日志\",\"width\":1000,\"centered\":\"\",\"footer\":\"\",\"maskClosable\":true,\"visible\":_vm.visible},on:{\"cancel\":_vm.cancel}},[_c('a-card',{attrs:{\"bordered\":false,\"size\":\"small\"}},[_c('a-descriptions',{attrs:{\"title\":\"执行信息\"}},[_c('a-descriptions-item',{attrs:{\"label\":\"命令名称\"}},[_vm._v(_vm._s(_vm.cmdName))]),_c('a-descriptions-item',{attrs:{\"label\":\"执行ID\"}},[_vm._v(_vm._s(_vm.record.id))]),_c('a-descriptions-item',{attrs:{\"label\":\"执行用户\"}},[_vm._v(_vm._s(_vm.record.user))])],1),_c('a-descriptions',[_c('a-descriptions-item',{attrs:{\"label\":\"状态\"}},[(_vm.record.result_at >0)?_c('span',{staticStyle:{\"color\":\"#3CB371\"}},[_vm._v(\"已完成\")]):_c('span',{staticStyle:{\"color\":\"#48D1CC\"}},[_vm._v(\"执行中\")])]),_c('a-descriptions-item',{attrs:{\"label\":\"创建时间\"}},[_vm._v(_vm._s(_vm._f(\"formatDate\")(_vm.record.create_at)))]),(_vm.record.result_at > 0)?_c('a-descriptions-item',{attrs:{\"label\":\"执行时长\"}},[_vm._v(_vm._s(_vm.record.result_at - _vm.record.create_at)+\" 秒\")]):_vm._e()],1),_c('a-descriptions',[_c('a-descriptions-item',{attrs:{\"label\":\"执行节点\"}},[_vm._v(_vm._s(_vm.record.node))]),_c('a-descriptions-item',{attrs:{\"label\":\"执行目录\"}},[_vm._v(\"\\\"\"+_vm._s(_vm.record.dir)+\"\\\"\")])],1),_c('a-divider',{staticStyle:{\"margin-bottom\":\"12px\"}}),_c('a-descriptions',{attrs:{\"title\":\"脚本内容\"}},[_c('div',[_c('a-textarea',{staticStyle:{\"background\":\"#0e0e0e\",\"color\":\"white\"},attrs:{\"value\":_vm.record.context,\"auto-size\":{ minRows: 4, maxRows: 10 }}})],1)]),_c('a-divider',{staticStyle:{\"margin-bottom\":\"12px\"}}),_c('a-descriptions',{attrs:{\"title\":\"执行结果\"}},[_c('div',[_c('a-textarea',{staticStyle:{\"background\":\"#0e0e0e\",\"color\":\"white\"},attrs:{\"value\":_vm.record.result,\"auto-size\":{ minRows: 4, maxRows: 10 }}})],1)])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <a-modal\n    title=\"执行日志\"\n    :width=\"1000\"\n    centered\n    footer=\"\"\n    :maskClosable=\"true\"\n    :visible=\"visible\"\n    @cancel=\"cancel\"\n  >\n    <a-card :bordered=\"false\" size=\"small\">\n      <a-descriptions title=\"执行信息\">\n        <a-descriptions-item label=\"命令名称\">{{ cmdName }}</a-descriptions-item>\n        <a-descriptions-item label=\"执行ID\">{{ record.id }}</a-descriptions-item>\n        <a-descriptions-item label=\"执行用户\">{{ record.user }}</a-descriptions-item>\n      </a-descriptions>\n      <a-descriptions>\n        <a-descriptions-item label=\"状态\">\n          <span v-if=\"record.result_at >0\" style=\"color:#3CB371\">已完成</span>\n          <span v-else style=\"color:#48D1CC\">执行中</span>\n        </a-descriptions-item>\n        <a-descriptions-item label=\"创建时间\">{{ record.create_at | formatDate }}</a-descriptions-item>\n        <a-descriptions-item v-if=\"record.result_at > 0\" label=\"执行时长\">{{ record.result_at - record.create_at }} 秒</a-descriptions-item>\n      </a-descriptions>\n      <a-descriptions>\n        <a-descriptions-item label=\"执行节点\">{{ record.node }}</a-descriptions-item>\n        <a-descriptions-item label=\"执行目录\">\"{{ record.dir }}\"</a-descriptions-item>\n      </a-descriptions>\n      <a-divider style=\"margin-bottom:12px\"/>\n      <a-descriptions title=\"脚本内容\">\n        <div>\n          <a-textarea\n            :value=\"record.context\"\n            :auto-size=\"{ minRows: 4, maxRows: 10 }\"\n            style=\"background: #0e0e0e; color: white\" />\n        </div>\n      </a-descriptions>\n      <a-divider style=\"margin-bottom:12px\"/>\n      <a-descriptions title=\"执行结果\">\n        <div>\n          <a-textarea\n            :value=\"record.result\"\n            :auto-size=\"{ minRows: 4, maxRows: 10 }\"\n            style=\"background: #0e0e0e; color: white\" />\n        </div>\n      </a-descriptions>\n    </a-card>\n  </a-modal>\n</template>\n\n<script>\nimport moment from 'moment'\n\nexport default {\n  name: 'LogInfo',\n  components: {\n    moment\n  },\n  props: {\n    visible: {\n      type: Boolean,\n      required: true\n    },\n    cmdName: {\n      type: String,\n      default: 'null'\n    },\n    record: {\n      type: Object,\n      default: null\n    }\n  },\n  data () {\n    return {\n\n    }\n  },\n  filters: {\n    formatDate (time) {\n      return moment.unix(time).format('YYYY-MM-DD HH:mm:ss')\n    }\n  },\n  mounted () {\n    console.log(this.cmdName, this.record)\n  },\n  methods: {\n    cancel () {\n      this.$emit('cancel')\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LogInfo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LogInfo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LogInfo.vue?vue&type=template&id=25ddfdb4&\"\nimport script from \"./LogInfo.vue?vue&type=script&lang=js&\"\nexport * from \"./LogInfo.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('page-header-wrapper',{attrs:{\"breadcrumb\":{},\"title\":\"执行命令\",\"content\":'( ' + _vm.form.name + ' )'},on:{\"back\":function () { return _vm.$router.go(-1); }}},[_c('a-card',{attrs:{\"bordered\":false}},[_c('a-spin',{attrs:{\"spinning\":_vm.spinning}},[_c('a-form-model',{ref:\"cmdExecForm\",attrs:{\"model\":_vm.form,\"rules\":_vm.formRule,\"label-col\":{ span: 2 },\"wrapper-col\":{ span: 20 }}},[_c('a-form-model-item',{attrs:{\"label\":\"命令类型\"}},[_c('span',[_vm._v(\"SHELL\")])]),_c('a-form-model-item',{attrs:{\"label\":\"命令内容\"}},[_c('a-textarea',{staticStyle:{\"background\":\"#0e0e0e\",\"color\":\"white\"},attrs:{\"auto-size\":{ minRows: 4, maxRows: 10 },\"readOnly\":_vm.ctx_readonly},model:{value:(_vm.form.context),callback:function ($$v) {_vm.$set(_vm.form, \"context\", $$v)},expression:\"form.context\"}})],1),_c('a-form-model-item',{attrs:{\"label\":\"执行目录\",\"wrapper-col\":{ span: 6}}},[_c('a-input',{attrs:{\"placeholder\":\"非必填，默认为节点启动目录\"},model:{value:(_vm.form.dir),callback:function ($$v) {_vm.$set(_vm.form, \"dir\", $$v)},expression:\"form.dir\"}})],1),_c('a-form-model-item',{attrs:{\"wrapper-col\":{ span: 4},\"prop\":\"timeout\"}},[_c('span',{attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\" 超时时间  \"),_c('a-tooltip',{attrs:{\"title\":\"可设置范围10～86400秒，默认60秒。超时后，会强制终止进程\"}},[_c('a-icon',{attrs:{\"type\":\"question-circle-o\"}})],1)],1),_c('a-input',{model:{value:(_vm.form.timeout),callback:function ($$v) {_vm.$set(_vm.form, \"timeout\", $$v)},expression:\"form.timeout\"}},[_c('span',{attrs:{\"slot\":\"addonAfter\"},slot:\"addonAfter\"},[_vm._v(\"秒\")])])],1),_c('a-form-model-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.hasArgs),expression:\"hasArgs\"}],attrs:{\"label\":\"命令参数\"}},[_c('a-row',{staticStyle:{\"background\":\"#F0F0F0\"}},[_c('a-col',{attrs:{\"span\":4}},[_vm._v(\"  参数名\")]),_c('a-col',{attrs:{\"span\":12}},[_vm._v(\"参数值\")])],1),_vm._l((_vm.form.args),function(v,kk){return [_c('a-row',{key:kk},[_c('a-col',{attrs:{\"span\":4}},[_c('span',[_vm._v(\"  \"+_vm._s(kk))])]),_c('a-col',{attrs:{\"span\":12}},[_c('a-input',{model:{value:(_vm.form.args[kk]),callback:function ($$v) {_vm.$set(_vm.form.args, kk, $$v)},expression:\"form.args[kk]\"}})],1)],1)]})],2),_c('a-form-model-item',{attrs:{\"label\":\"选择执行节点\",\"prop\":\"node\",\"wrapper-col\":{ span: 4}}},[_c('a-select',{attrs:{\"placeholder\":\"选择一个可执行的节点\"},model:{value:(_vm.form.node),callback:function ($$v) {_vm.$set(_vm.form, \"node\", $$v)},expression:\"form.node\"}},[_vm._l((_vm.nodes),function(v,i){return [_c('a-select-option',{key:i,attrs:{\"value\":v.name}},[_vm._v(\" \"+_vm._s(v.name)+\" \")])]})],2)],1),_c('a-form-model-item',{attrs:{\"wrapper-col\":{ span: 12,offset:2 }}},[_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(\" 执行命令 \")])],1)],1)],1)],1),_c('a-log-info',{attrs:{\"visible\":_vm.logInfoVisible,\"cmdName\":_vm.logInfoCmd,\"record\":_vm.logInfoRecord},on:{\"cancel\":_vm.logInfoCancel}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <page-header-wrapper\n    :breadcrumb=\"{}\"\n    title=\"执行命令\"\n    :content=\"'( ' + form.name + ' )'\"\n    @back=\"() => $router.go(-1)\"\n  >\n\n    <a-card :bordered=\"false\">\n      <a-spin :spinning=\"spinning\">\n        <a-form-model\n          ref=\"cmdExecForm\"\n          :model=\"form\"\n          :rules=\"formRule\"\n          :label-col=\"{ span: 2 }\"\n          :wrapper-col=\"{ span: 20 }\"\n        >\n          <a-form-model-item label=\"命令类型\">\n            <span>SHELL</span>\n          </a-form-model-item>\n          <a-form-model-item label=\"命令内容\" >\n            <a-textarea\n              v-model=\"form.context\"\n              :auto-size=\"{ minRows: 4, maxRows: 10 }\"\n              :readOnly=\"ctx_readonly\"\n              style=\"background: #0e0e0e; color: white\"\n            />\n          </a-form-model-item>\n\n          <a-form-model-item label=\"执行目录\" :wrapper-col=\"{ span: 6}\">\n            <a-input v-model=\"form.dir\" placeholder=\"非必填，默认为节点启动目录\" />\n          </a-form-model-item>\n\n          <a-form-model-item :wrapper-col=\"{ span: 4}\" prop=\"timeout\">\n            <span slot=\"label\">\n              超时时间&nbsp;\n              <a-tooltip title=\"可设置范围10～86400秒，默认60秒。超时后，会强制终止进程\">\n                <a-icon type=\"question-circle-o\" />\n              </a-tooltip>\n            </span>\n            <a-input v-model=\"form.timeout\" >\n              <span slot=\"addonAfter\" >秒</span>\n            </a-input>\n          </a-form-model-item>\n          <a-form-model-item\n            label=\"命令参数\"\n            v-show=\"hasArgs\"\n          >\n            <a-row style=\"background:#F0F0F0\">\n              <a-col :span=\"4\">&nbsp;&nbsp;参数名</a-col>\n              <a-col :span=\"12\">参数值</a-col>\n            </a-row>\n            <template v-for=\"(v,kk) in form.args\" >\n              <a-row :key=\"kk\">\n                <a-col :span=\"4\">\n                  <span >&nbsp;&nbsp;{{ kk }}</span>\n                </a-col>\n                <a-col :span=\"12\">\n                  <a-input v-model=\"form.args[kk]\" />\n                </a-col>\n              </a-row>\n            </template>\n          </a-form-model-item>\n          <a-form-model-item label=\"选择执行节点\" prop=\"node\" :wrapper-col=\"{ span: 4}\">\n            <a-select\n              placeholder=\"选择一个可执行的节点\"\n              v-model=\"form.node\"\n            >\n              <template v-for=\"(v,i) in nodes\" >\n                <a-select-option :value=\"v.name\" :key=\"i\">\n                  {{ v.name }}\n                </a-select-option>\n              </template>\n            </a-select>\n          </a-form-model-item>\n          <a-form-model-item :wrapper-col=\"{ span: 12,offset:2 }\">\n            <a-button type=\"primary\" @click=\"onSubmit\">\n              执行命令\n            </a-button>\n          </a-form-model-item>\n        </a-form-model>\n      </a-spin>\n    </a-card>\n\n    <a-log-info\n      :visible=\"logInfoVisible\"\n      :cmdName=\"logInfoCmd\"\n      :record=\"logInfoRecord\"\n      @cancel=\"logInfoCancel\"\n    >\n    </a-log-info>\n  </page-header-wrapper>\n</template>\n\n<script>\nimport { nodeList } from '@/api/node'\nimport { cmdExec } from '@/api/command'\nimport LogInfo from './modal/LogInfo'\n\nexport default {\n  name: 'CmdExec',\n  components: {\n    'a-log-info': LogInfo\n  },\n  data () {\n    return {\n      formRule: {\n        timeout: [{ validator: this.checkTimout, message: '请设置一个合适的时间', trigger: 'change' }],\n        node: [{ required: true, message: '选择一个节点', trigger: 'blur' }]\n      },\n      ctx_readonly: true,\n      hasArgs: false,\n      nodes: [],\n      form: {\n        id: 0,\n        name: '',\n        context: '',\n        dir: '',\n        args: {},\n        node: '',\n        timeout: 60\n      },\n      spinning: false,\n\n       logInfoVisible: false,\n      logInfoCmd: '',\n      logInfoRecord: {}\n    }\n  },\n  mounted () {\n    if (this.$route.params.record) {\n      this.form = { ...this.$route.params.record, timeout: 60 }\n      this.hasArgs = Object.keys(this.form.args).length > 0\n    } else {\n      this.$router.back()\n    }\n    this.getNodeList()\n  },\n  methods: {\n    getNodeList () {\n      const args = { pageNo: 1, pageSize: 1000 }\n      nodeList(args)\n        .then(res => {\n          for (const idx in res.nodeList) {\n            const v = res.nodeList[idx]\n            if (v.online) {\n              this.nodes.push(v)\n            }\n          }\n        })\n    },\n    onSubmit () {\n     this.$refs.cmdExecForm.validate(valid => {\n        if (valid) {\n          const args = {\n            id: this.form.id,\n            dir: this.form.dir,\n            args: this.form.args,\n            node: this.form.node,\n            timeout: parseInt(this.form.timeout)\n          }\n          const tout = (this.form.timeout + 6) * 1000\n          console.log(tout, this.form, args)\n          this.spinning = true\n          cmdExec(tout, args)\n            .then(res => {\n              console.log(res)\n              this.spinning = false\n              this.showLogInfo(res)\n            })\n            .catch(e => { })\n            .finally(e => {\n              this.spinning = false\n            })\n        } else {\n          console.log('error submit!!')\n          return false\n        }\n     })\n    },\n    checkTimout (rule, value, callback) {\n      if (value < 10 || value > 86400) {\n        callback(new Error('请输入一个合适的超时时长'))\n      } else {\n        callback()\n      }\n    },\n    showLogInfo (record) {\n      this.logInfoVisible = true\n      this.logInfoCmd = this.cmdName\n      this.logInfoRecord = record\n    },\n    logInfoCancel () {\n      this.logInfoVisible = false\n    }\n\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CmdExec.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CmdExec.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CmdExec.vue?vue&type=template&id=1f5daa03&scoped=true&\"\nimport script from \"./CmdExec.vue?vue&type=script&lang=js&\"\nexport * from \"./CmdExec.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1f5daa03\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\n\nconst cmdApi = {\n  cmdList: 'cmd/list',\n  cmdCreate: 'cmd/create',\n  cmdDelete: 'cmd/delete',\n  cmdUpdate: 'cmd/update',\n  cmdExec: 'cmd/exec',\n  cmdLog: 'cmd/log'\n}\n\n/**\n * login func\n * parameter: {\n *     username: '',\n *     password: '',\n *     remember_me: true,\n *     captcha: '12345'\n * }\n * @param parameter\n * @returns {*}\n */\nexport function cmdList (parameter) {\n  return request({\n    url: cmdApi.cmdList,\n    method: 'post',\n    data: parameter\n  })\n}\n\nexport function cmdCreate (parameter) {\n  return request({\n    url: cmdApi.cmdCreate,\n    method: 'post',\n    data: parameter\n  })\n}\n\nexport function cmdDelete (parameter) {\n  return request({\n    url: cmdApi.cmdDelete,\n    method: 'post',\n    data: parameter\n  })\n}\n\nexport function cmdUpdate (parameter) {\n  return request({\n    url: cmdApi.cmdUpdate,\n    method: 'post',\n    data: parameter\n  })\n}\n\nexport function cmdExec (timeout, parameter) {\n  return request({\n    url: cmdApi.cmdExec,\n    method: 'post',\n    timeout: timeout,\n    data: parameter\n  })\n}\n\nexport function cmdLog (parameter) {\n  return request({\n    url: cmdApi.cmdLog,\n    method: 'post',\n    data: parameter\n  })\n}\n"],"sourceRoot":""}